{% extends "common.html" %}

{% load url from future %}

{% block content %}
<div class="row">
	<div class="span12">
		<ul class="breadcrumb">
			<li><a href="{% url 'index' %}">Библиотека Everypony.ru</a> <span class="divider">/</span></li>
			<li><a href="{% url 'author_dashboard' %}">Кабинет автора</a> <span class="divider">/</span></li>
			<li class="active">{{ page_title }}</li>
		</ul>
	</div>
	
	<div class="span12">
		<h1>{{ page_title }}</h1>
		{% if not story_edit %}
			<p>Перед добавлением рассказа рекомендуем прочитать <a href="#">правила</a>, <a href="#">рекомендации</a> и <a href="#">инструкции</a>. Они сделают вашу жизнь и жизни читателей проще.</p>
			<p>Вкратце:</p>
			<ul>
				<li>Сейчас вы задаете основные параметры рассказа. Следующим шагом будет добавление глав.</li>
				<li>Не забудьте опубликовать рассказ в кабинете автора, когда закончите писать чистовик.</li>
			</ul>
		{% endif %}
		
		<form method="POST" enctype="multipart/form-data" class="form-horizontal">
		{% csrf_token %}
			<fieldset>
				<legend>Параметры рассказа</legend>
				
				<!-- Название -->
				<div class="control-group{% if form.title.errors %} error{% endif %}">
					<label class="control-label">{{ form.title.label }}</label>
					<div class="controls">{{ form.title }}</div>
					{% if form.title.errors %}
						{% for error in form.title.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.title.help_text }}</span>
					{% endif %}
				</div>
				<!-- Жанры -->
				<div class="control-group{% if form.categories.errors %} error{% endif %}">
					<label class="control-label">{{ form.categories.label }}</label>
					<div class="controls genres-select">{{ form.categories }}</div>
					{% if form.categories.errors %}
						{% for error in form.categories.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.categories.help_text }}</span>
					{% endif %}
				</div>
				<!-- Персонажи -->
				<div class="control-group{% if form.characters.errors %} error{% endif %}">
					<label class="control-label">{{ form.characters.label }}</label>
					<div class="controls characters-select">{{ form.characters }}</div>
					{% if form.characters.errors %}
						{% for error in form.characters.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.characters.help_text }}</span>
					{% endif %}
				</div>
				<!-- Общее описание -->
			    <div class="control-group{% if form.summary.errors %} error{% endif %}">
					<label class="control-label">{{ form.summary.label }}</label>
					<div class="controls">{{ form.summary }}</div>
					{% if form.summary.errors %}
						{% for error in form.summary.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.summary.help_text }}</span>
					{% endif %}
				</div>
				<!-- Заметки к рассказу -->
			    <div class="control-group{% if form.notes.errors %} error{% endif %}">
					<label class="control-label">{{ form.notes.label }}</label>
					<div class="controls">{{ form.notes }}</div>
					{% if form.notes.errors %}
						{% for error in form.notes.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.notes.help_text }}</span>
					{% endif %}
				</div>
				<!-- Рейтинг -->
				<div class="control-group{% if form.rating.errors %} error{% endif %}">
					<label class="control-label">{{ form.rating.label }}</label>
					<div class="controls bootstrap radio">{{ form.rating }}</div>
					{% if form.rating.errors %}
						{% for error in form.rating.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.rating.help_text }}</span>
					{% endif %}
				</div>
				<!-- Размер -->
				<div class="control-group{% if form.size.errors %} error{% endif %}">
					<label class="control-label">{{ form.size.label }}</label>
					<div class="controls bootstrap radio">{{ form.size }}</div>
					{% if form.size.errors %}
						{% for error in form.size.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.size.help_text }}</span>
					{% endif %}
				</div>
				<!-- Оригинал/перевод -->
				<div class="control-group{% if form.original.errors %} error{% endif %}">
					<label class="control-label">{{ form.original.label }}</label>
					<div class="controls bootstrap radio">{{ form.original }}</div>
					{% if form.original.errors %}
						{% for error in form.original.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.original.help_text }}</span>
					{% endif %}
				<!-- Заморожен/активен -->
				</div>
				<div class="control-group{% if form.freezed.errors %} error{% endif %}">
					<label class="control-label">{{ form.freezed.label }}</label>
					<div class="controls bootstrap radio">{{ form.freezed }}</div>
					{% if form.freezed.errors %}
						{% for error in form.freezed.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.freezed.help_text }}</span>
					{% endif %}
				</div>
				<!-- Категории -->
				<div class="control-group{% if form.classifications.errors %} error{% endif %}">
					<label class="control-label">{{ form.classifications.label }}</label>
					<div class="controls events">{{ form.classifications }}</div>
					{% if form.classifications.errors %}
						{% for error in form.classifications.errors %}
							<span class="help-inline">{{ error }}</span>
						{% endfor %}
					{% else %}
						<span class="help-inline small">{{ form.classifications.help_text }}</span>
					{% endif %}
				</div>
				<!-- Отправить -->
      			<div class="form-actions">
      				{{ form.button_submit }}
      				{% if story_edit %}
	      				<!-- Псевдокнопка активации модального окна подтверждения -->
	      				<input href="#delete_story" class="btn btn-danger" type="button" data-toggle="modal" value="Удалить рассказ">
	      				<!-- Modal -->
						<div id="delete_story" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-header">
						    	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
						    	<h3 id="myModalLabel">Удаление рассказа</h3>
							</div>
							<div class="modal-body">
								<p>Вы действительно хотите удалить рассказ?</p>
								<p>Вся связанная статистика, главы, оценки и комментарии также будут безвозвратно удалены!</p>
							</div>
							<div class="modal-footer">
								<button class="btn" data-dismiss="modal" aria-hidden="true">Отменить</button>
								{{ form.button_delete }}
							</div>
						</div>
					{% endif %}
      			</div>
      			{% if story_edit %}
      				<legend>Главы</legend>
      				<div class="control-group">
        				<div class="controls events">   
							<ul id="sortable_chapters" class="chapters-control">
								{% for chapter in chapters %}
          							<li id="chapters_{{ chapter.id }}" class="btn btn-large">{{ chapter.title }}<a href="#">править</a> <a href="#">удалить</a></li>
								{% endfor %}
							</ul>
							<button href="#" class="btn btn-success">Добавить главу</button>
						</div>
					</div>
      			{% endif %}
      		</fieldset>
    	</form>
  	</div>     

	<div class="span12">
		<ul class="breadcrumb">
      		<li><a href="{% url 'index' %}">Библиотека Everypony.ru</a> <span class="divider">/</span></li>
      		<li><a href="{% url 'author_dashboard' %}">Кабинет автора</a> <span class="divider">/</span></li>
      		<li class="active">{{ page_title }}</li>
    	</ul>
  	</div>
</div>
{% endblock %}